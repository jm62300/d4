This directory contains files to perform fuzzy testing on circuit inputs.

# Usage

The fuzzy tester will extract the model count using the specified run configurations and compare the results.
When a difference is detected, it will print information to stderr. 
Therefore, when fuzzy testing on many instances, it is advised to write the errors to a separate file.  (i.e., run with `2> err.txt`)

In case of an error, it will print the used seed and the model count for each configuration.
The seed corresponds to the CNF and BC filename that is then also left behind in the current folder.


Usage example,

```
python3.10 fuzzy_testing.py -i ./counter -t 120 -n 100 --runconfigs cnf circuit_cnf circuit_cnf_equiv circuit_pcnf circuit_pcnf_dynbl circuit_pcnf_preproc0 circuit_pcnf_preproc1
```

Use the `-h` argument to print usage information. Note that `--runconfigs` is 'multiple choice' and 
specifies the configurations to test against eachother.

```
usage: fuzzy_testing.py [-h] [-t T] [-n N] -i I
                        [--runconfigs {cnf,circuit,circuit_cnf,circuit_cnf_equiv,circuit_pcnf,circuit_pcnf_dynbl,circuit_pcnf_preproc0,circuit_pcnf_preproc1} [{cnf,circuit,circuit_cnf,circuit_cnf_equiv,circuit_pcnf,circuit_pcnf_preproc0,circuit_pcnf_preproc1} ...]]

options:
  -h, --help            show this help message and exit
  -t T                  The timeout for each instance (seconds).
  -n N                  Number of instances to try.
  -i I                  Filepath to a D4 counter binary.
  --runconfigs {cnf,circuit,circuit_cnf,circuit_cnf_equiv,circuit_pcnf,circuit_pcnf_dynbl,circuit_pcnf_preproc0,circuit_pcnf_preproc1} [{cnf,circuit,circuit_cnf,circuit_cnf_equiv,circuit_pcnf,circuit_pcnf_preproc0,circuit_pcnf_preproc1} ...]
                        Which configurations to test
```


In the main() method near the bottom you can find additional parameters you can tune,
that control the random circuit generation process.
As of now, the circuits are between 2-20 inputs nodes and 2-100 gates.


As of now, a circuit is generated by starting from some input nodes, and 
randomly selecting existing nodes (gate or input) to form a new gate with.
There are parameters to control the probability of OR/AND, and the polarity of each gate input. 
There is also a parameter that influences the number of inputs per gate.
Finally, there are parameters to control the number of input nodes, and the number of gates.


## Dependencies
No additional dependencies should be required. This was tested with Python3.10. A higher version should work fine.


# Run configurations
// cnf: Run a CNF file
COUNTER --input-type cnf -i BENCH

// circuit_cnf: Translate into CNF
COUNTER --input-type circuit -i BENCH --translate cnf

// circuit_pcnf: Translate into projected CNF
COUNTER --input-type circuit -i BENCH --translate pcnf

// circuit_pcnf_dynbl: Translate into projected CNF with occ dynamicBlockedSimp
COUNTER --input-type circuit -i BENCH --translate pcnf --occurrence-manager dynamicBlockedSimp

// circuit_cnf_equiv: Translate into CNF and use the preprocessor to keep the formula equivalent
COUNTER --input-type circuit -i BENCH --translate cnf  -p equiv

// circuit_pcnf_preproc0: Translate into projected CNF and use the preprocessor to forget existentially quantified variables without impacting the formula's size
COUNTER --input-type circuit -i BENCH --translate pcnf --occurrence-manager dynamicBlockedSimp -p compile-equiv --preproc-strong-elim 0

// circuit_pcnf_preproc1: Translate into projected CNF and use the preprocessor to forget existentially quantified variables
COUNTER --input-type circuit -i BENCH --translate pcnf --occurrence-manager dynamicBlockedSimp -p compile-equiv --preproc-strong-elim 1


- Vincent Derkinderen 2024
